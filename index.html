<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AR –ì—Ä–∞: –ü–µ—Ä—à–∏–π –î–µ–Ω—å —É –®–∫–æ–ª—ñ - –í–µ—Å–µ–ª–æ!</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@master/aframe/build/aframe-ar.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      touch-action: none; /* –±–ª–æ–∫—É—î pinch zoom */
      font-family: Arial, sans-serif;
    }
    a-scene {
      width: 100%;
      height: 100%;
      position: fixed;
      top: 0;
      left: 0;
    }
    #scanText {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #FFD700;
      font-size: 2em;
      font-weight: bold;
      text-shadow: 2px 2px 6px #000;
      z-index: 10;
      text-align: center;
      width: 90%;
    }
    #smartLessaBtn {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ff0044;
      color: white;
      padding: 14px 24px;
      border-radius: 30px;
      font-size: 1.1em;
      font-weight: bold;
      text-decoration: none;
      z-index: 10;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    #smartLessaBtn:hover {
      background: #cc0036;
    }
  </style>
</head>
<body>
  <div id="scanText">–ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è Hiro –º–∞—Ä–∫–µ—Ä–∞</div>

  <a-scene embedded id="arScene" arjs="sourceType: webcam; detectionMode: mono; trackingMethod: best; facingBack: true;">
    <a-marker id="marker" preset="hiro">
      <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥—Ä–∏ -->
      <a-entity id="game-container" position="0 0 0" rotation="-90 0 0" scale="0.05 0.05 0.05">
        <a-text id="event-text" value="" position="-1 2 0" width="40" align="center" color="white"></a-text>
        <a-entity id="choiceA" class="choice" position="-1 1 0">
          <a-plane width="2" height="0.5" material="color: green; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="choiceB" class="choice" position="-1 0.5 0">
          <a-plane width="2" height="0.5" material="color: green; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="choiceC" class="choice" position="-1 0 0">
          <a-plane width="2" height="0.5" material="color: green; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="result-container" visible="false">
          <a-text id="result-text" value="" position="-1 1 0" width="40" align="center" color="yellow"></a-text>
          <a-entity id="restart-btn" class="clickable" position="-1 0 0">
            <a-plane width="1.5" height="0.5" material="color: blue; opacity: 0.7"></a-plane>
            <a-text value="–†–æ–∑–ø–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É" width="20" align="center" color="white" position="-0.7 -0.2 0.01"></a-text>
          </a-entity>
        </a-entity>
      </a-entity>
    </a-marker>
    <a-entity camera>
      <a-cursor></a-cursor>
    </a-entity>
  </a-scene>

  <a href="https://youtube.com/playlist?list=PL6UDFwT9TzFxsVdFiEBsQ9yFpcYRPOpfO&si=IyXv1SkdPyvhcW7Z"
     id="smartLessaBtn" target="_blank">@SmartLessa</a>

  <script>
    const marker = document.getElementById('marker');
    const scanText = document.getElementById('scanText');
    const gameContainer = document.getElementById('game-container');
    const eventText = document.getElementById('event-text');
    const choiceA = document.getElementById('choiceA');
    const choiceB = document.getElementById('choiceB');
    const choiceC = document.getElementById('choiceC');
    const resultContainer = document.getElementById('result-container');
    const resultText = document.getElementById('result-text');
    const restartBtn = document.getElementById('restart-btn');

    // –ü–æ–¥—ñ—ó —à–∫—ñ–ª—å–Ω–æ–≥–æ –¥–Ω—è (–µ—Ç–∞–ø–∏ –≥—Ä–∏)
    const schoolEvents = [
      {
        event: "–¢–∏ –ø—Ä–∏—Ö–æ–¥–∏—à –¥–æ —à–∫–æ–ª–∏. –©–æ —Ä–æ–±–∏—à –ø–µ—Ä—à–∏–º?",
        choices: [
          { text: "A) –í—ñ—Ç–∞—î—à—Å—è –∑ –¥—Ä—É–∑—è–º–∏", fun: 2, friends: 1 },
          { text: "B) –ô–¥–µ—à –¥–æ –∫–ª–∞—Å—É –æ–¥—Ä–∞–∑—É", fun: 1, friends: 0 },
          { text: "C) –î–æ—Å–ª—ñ–¥–∂—É—î—à —à–∫—ñ–ª—å–Ω–∏–π –¥–≤—ñ—Ä", fun: 3, friends: 0.5 }
        ]
      },
      {
        event: "–ù–∞ —É—Ä–æ—Ü—ñ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –≤—á–∏—Ç–µ–ª—å–∫–∞ –∑–∞–¥–∞—î –ø–∏—Ç–∞–Ω–Ω—è. –¢–≤–æ—è –¥—ñ—è?",
        choices: [
          { text: "A) –ü—ñ–¥–Ω—ñ–º–∞—î—à —Ä—É–∫—É —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î—à", fun: 1, knowledge: 2 },
          { text: "B) –®–µ–ø–æ—á–µ—à –≤—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–æ–≤—ñ", fun: 2, knowledge: 1, friends: 1 },
          { text: "C) –ú–∞–ª—é—î—à —Å–º—ñ—à–Ω—ñ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –∑–æ—à–∏—Ç—ñ", fun: 3, knowledge: 0 }
        ]
      },
      {
        event: "–ù–∞ –ø–µ—Ä–µ—Ä–≤—ñ –¥—Ä—É–∑—ñ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –ø–æ–≥—Ä–∞—Ç–∏. –©–æ –æ–±–∏—Ä–∞—î—à?",
        choices: [
          { text: "A) –§—É—Ç–±–æ–ª –Ω–∞ –ø–æ–¥–≤—ñ—Ä'—ó", fun: 3, energy: -1, friends: 2 },
          { text: "B) –†–æ–∑–º–æ–≤–ª—è—î—à –ø—Ä–æ –∫–∞–Ω—ñ–∫—É–ª–∏", fun: 2, energy: 0, friends: 1 },
          { text: "C) –•–æ–≤–∞—î—à—Å—è –≤ —à–∫—ñ–ª—å–Ω–æ–º—É —Å–∞–¥—É", fun: 2.5, energy: -0.5, friends: 0.5 }
        ]
      },
      {
        event: "–í —ó–¥–∞–ª—å–Ω—ñ –æ–±—ñ–¥. –©–æ –∑'—ó—Å–∏?",
        choices: [
          { text: "A) –ó–¥–æ—Ä–æ–≤–∏–π —Å–∞–ª–∞—Ç —ñ —Å—É–ø", fun: 1, energy: 2 },
          { text: "B) –ü—ñ—Ü—É –∑ –¥—Ä—É–∑—è–º–∏", fun: 3, energy: 1, friends: 1 },
          { text: "C) –°–æ–ª–æ–¥–æ—â—ñ –ø–æ—Ç–∞–π–∫–∏", fun: 2.5, energy: 0.5 }
        ]
      },
      {
        event: "–ü—ñ—Å–ª—è —É—Ä–æ–∫—ñ–≤. –Ø–∫ –∑–∞–≤–µ—Ä—à–∏—à –¥–µ–Ω—å?",
        choices: [
          { text: "A) –î–æ–ø–æ–º–∞–≥–∞—î—à –ø—Ä–∏–±–∏—Ä–∞—Ç–∏ –∫–ª–∞—Å", fun: 1, knowledge: 1, friends: 1 },
          { text: "B) –ì—Ä–∞—î—à —É —ñ–≥—Ä–∏ –∑ –æ–¥–Ω–æ–∫–ª–∞—Å–Ω–∏–∫–∞–º–∏", fun: 3, friends: 2 },
          { text: "C) –ë—ñ–∂–∏—à –¥–æ–¥–æ–º—É —Ä–æ–∑–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø—Ä–æ –¥–µ–Ω—å", fun: 2, energy: -1 }
        ]
      }
    ];

    // –†–∞–Ω–¥–æ–º–Ω—ñ –ø–æ–¥—ñ—ó –¥–ª—è —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–æ—Å—Ç—ñ
    const randomEvents = [
      "–†–∞–ø—Ç–æ–º –≤—á–∏—Ç–µ–ª—å–∫–∞ —Ä–æ–∑–ø–æ–≤—ñ–¥–∞—î —Å–º—ñ—à–Ω–∏–π –∂–∞—Ä—Ç! +1 –≤–µ—Å–µ–ª–æ—â—ñ",
      "–¢–∏ –∑–Ω–∞—Ö–æ–¥–∏—à –∑–∞–±—É—Ç—É —ñ–≥—Ä–∞—à–∫—É –≤ —à–∫—ñ–ª—å–Ω–æ–º—É –¥–≤–æ—Ä—ñ! +1 –¥—Ä—É–∑—ñ",
      "–ù–∞ –ø–µ—Ä–µ—Ä–≤—ñ –ø–∞–¥–∞—î –¥–æ—â, –∞–ª–µ –≤–∏ –≥—Ä–∞—î—Ç–µ –ø—ñ–¥ –¥–∞—Ö–æ–º. +1 –µ–Ω–µ—Ä–≥—ñ—è",
      "–î—Ä—É–≥ –¥—ñ–ª–∏—Ç—å—Å—è —Ü—É–∫–µ—Ä–∫–æ—é. +0.5 –≤–µ—Å–µ–ª–æ—â—ñ",
      "–¢–∏ –¥–æ–ø–æ–º–∞–≥–∞—î—à –Ω–æ–≤–æ–º—É —É—á–Ω—é –∑–Ω–∞–π—Ç–∏ –∫–ª–∞—Å. +1 –∑–Ω–∞–Ω–Ω—è"
    ];

    let currentEvent = 0;
    let funLevel = 0;
    let friendsMade = 0;
    let knowledgeGained = 0;
    let energyLeft = 5; // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –µ–Ω–µ—Ä–≥—ñ—è

    function startGame() {
      currentEvent = 0;
      funLevel = 0;
      friendsMade = 0;
      knowledgeGained = 0;
      energyLeft = 5;
      resultContainer.setAttribute('visible', false);
      showEvent();
    }

    function showEvent() {
      if (currentEvent < schoolEvents.length && energyLeft > 0) {
        const e = schoolEvents[currentEvent];
        eventText.setAttribute('value', e.event);
        choiceA.querySelector('a-text').setAttribute('value', e.choices[0].text);
        choiceB.querySelector('a-text').setAttribute('value', e.choices[1].text);
        choiceC.querySelector('a-text').setAttribute('value', e.choices[2].text);

        // –î–æ–¥–∞—î–º–æ —Ä–∞–Ω–¥–æ–º–Ω—É –ø–æ–¥—ñ—é –¥–ª—è —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–æ—Å—Ç—ñ
        if (Math.random() > 0.5) { // 50% —à–∞–Ω—Å
          const randomIndex = Math.floor(Math.random() * randomEvents.length);
          const randomEvent = randomEvents[randomIndex];
          eventText.setAttribute('value', e.event + '\n' + randomEvent);
          // –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –µ—Ñ–µ–∫—Ç —Ä–∞–Ω–¥–æ–º–Ω–æ—ó –ø–æ–¥—ñ—ó
          if (randomEvent.includes('–≤–µ—Å–µ–ª–æ—â—ñ')) funLevel += parseFloat(randomEvent.match(/\+([\d.]+)/)[1]);
          if (randomEvent.includes('–¥—Ä—É–∑—ñ')) friendsMade += parseFloat(randomEvent.match(/\+([\d.]+)/)[1]);
          if (randomEvent.includes('–µ–Ω–µ—Ä–≥—ñ—è')) energyLeft += parseFloat(randomEvent.match(/\+([\d.]+)/)[1]);
          if (randomEvent.includes('–∑–Ω–∞–Ω–Ω—è')) knowledgeGained += parseFloat(randomEvent.match(/\+([\d.]+)/)[1]);
        }
      } else {
        showResult();
      }
    }

    function handleChoice(choiceIndex) {
      if (currentEvent >= schoolEvents.length) return;
      const e = schoolEvents[currentEvent];
      const selected = e.choices[choiceIndex];
      funLevel += selected.fun || 0;
      friendsMade += selected.friends || 0;
      knowledgeGained += selected.knowledge || 0;
      energyLeft += selected.energy || 0;

      // –†–∞–Ω–¥–æ–º–Ω–µ –∑–º–µ–Ω—à–µ–Ω–Ω—è –µ–Ω–µ—Ä–≥—ñ—ó –¥–ª—è —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ
      if (Math.random() > 0.7) {
        energyLeft -= 0.5;
        eventText.setAttribute('value', eventText.getAttribute('value') + '\n–¢—Ä–æ—Ö–∏ –≤—Ç–æ–º–∏–≤—Å—è... -0.5 –µ–Ω–µ—Ä–≥—ñ—è');
      }

      currentEvent++;
      showEvent();
    }

    function showResult() {
      eventText.setAttribute('value', '');
      choiceA.querySelector('a-text').setAttribute('value', '');
      choiceB.querySelector('a-text').setAttribute('value', '');
      choiceC.querySelector('a-text').setAttribute('value', '');
      let badge = '';
      if (funLevel > 10) badge = '–°—É–ø–µ—Ä-–≤–µ—Å–µ–ª–∏–π –¥–µ–Ω—å! üéâüéâüéâ';
      else if (funLevel > 5) badge = '–í–µ—Å–µ–ª–∏–π –¥–µ–Ω—å! üéâüéâ';
      else badge = '–¶—ñ–∫–∞–≤–∏–π –¥–µ–Ω—å! üéâ';
      resultText.setAttribute('value', `–¢–≤—ñ–π –¥–µ–Ω—å —É —à–∫–æ–ª—ñ:\n–í–µ—Å–µ–ª–æ—â—ñ: ${funLevel}\n–î—Ä—É–∑—ñ: ${friendsMade}\n–ó–Ω–∞–Ω–Ω—è: ${knowledgeGained}\n–ï–Ω–µ—Ä–≥—ñ—è: ${energyLeft}\n${badge}`);
      resultContainer.setAttribute('visible', true);
    }

    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∫–ª—ñ–∫—ñ–≤
    choiceA.addEventListener('click', () => handleChoice(0));
    choiceB.addEventListener('click', () => handleChoice(1));
    choiceC.addEventListener('click', () => handleChoice(2));
    restartBtn.addEventListener('click', startGame);

    // –ü–æ–¥—ñ—ó –º–∞—Ä–∫–µ—Ä–∞
    marker.addEventListener('markerFound', () => {
      scanText.style.display = 'none';
      startGame();
    });

    marker.addEventListener('markerLost', () => {
      scanText.style.display = 'block';
    });

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–∞–º–µ—Ä–∏
    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
      .then(stream => {
        console.log('–î–æ—Å—Ç—É–ø –¥–æ –∑–∞–¥–Ω—å–æ—ó –∫–∞–º–µ—Ä–∏ –Ω–∞–¥–∞–Ω–æ');
      })
      .catch(err => {
        scanText.textContent = '–î–æ–∑–≤–æ–ª—å—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞–¥–Ω—å–æ—ó –∫–∞–º–µ—Ä–∏ –¥–ª—è AR';
        console.error('–ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –∫–∞–º–µ—Ä–∏:', err);
      });

    // –§—ñ–∫—Å –≤–∏—Å–æ—Ç–∏ –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –±—Ä–∞—É–∑–µ—Ä—ñ–≤
    function fixHeight() {
      document.body.style.height = window.innerHeight + 'px';
    }
    window.addEventListener('resize', fixHeight);
    fixHeight();
  </script>
</body>
</html>